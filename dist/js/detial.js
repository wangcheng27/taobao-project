"use strict";var paramindex,urlParams=location.search.match(/id=(\d+)/);urlParams||(paramindex=layer.msg("非法访问！",{icon:2}),setTimeout(function(){return layer.close(paramindex),!(location.href="./list.html?pid=2")},800));var id=urlParams[1],loadindex=layer.load(1,{shade:[.5,"#333"]});async function temp(){var a=(await $.ajax({url:"/detial",data:{id:id},dataType:"json"})).data;console.log(a),$(".pib-title-detail").text(a.name),$(".price-line>span").text(a.price),$(".addCart .number").attr("data-stock",a.stock);for(var e=a.imgpath.split("=========="),t=0;t<e.length;t++)$(".wraper>ul").append($('<li><img src="'+e[t]+'"></li>'));$(".enlarge .middle>img").attr("src",e[0]),$(".enlarge .middle .big>img").attr("src",e[0]),enlarge(),layer.close(loadindex)}temp(),$(".add").click(function(){var a=+$(this).prev().val();$(this).next().prop("disabled",!1),++a>=$(this).parent().attr("data-stock")&&(a=$(this).parent().attr("data-stock"),$(this).prop("disabled",!0)),$(this).prev().val(a)}),$(".reduce").click(function(){var a=+$(this).prev().prev().val();$(this).prev().prop("disabled",!1),--a<=1&&(a=1,$(this).prop("disabled",!0)),$(this).prev().prev().val(a)}),$(".addCart .addBtn").click(function(){var e=getCookie("username");if(!e){var a=layer.msg("请先登录！");return setTimeout(function(){layer.close(a),localStorage.setItem("url",location.href),location.href="./logon.html"},2e3),!1}var t,r=localStorage.getItem("data");r?((t=(r=JSON.parse(r)).filter(function(a){return a.username===e&&a.goodsid===id})).length?t[0].number=t[0].number+ +$(".add").prev().val():r.push({username:e,goodsid:id,number:+$(".add").prev().val()}),localStorage.setItem("data",JSON.stringify(r))):localStorage.setItem("data",JSON.stringify([{username:e,goodsid:id,number:+$(".add").prev().val()}])),layer.msg("加入购物车成功",{icon:1,time:1e3})}),layer.close(loadindex);